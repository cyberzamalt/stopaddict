<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0ea5e9" />
  <title>StopAddict</title>
  <link rel="stylesheet" href="./css/app.css?v=monolithe" />
</head>
<body>
  <!-- Header -->
  <header class="app-header">
    <div class="header-left">
      <h1 id="app-title">StopAddict</h1>
      <div class="date-line">
        <span id="today-date"></span>
        <span id="hdr-status" class="status-dot" title="Statut">â€¢</span>
      </div>
    </div>
    <div class="header-right kpis">
      <div class="kpi"><span>ğŸš¬</span><strong id="hdr-cigs">0</strong></div>
      <div class="kpi"><span>ğŸŒ¿</span><strong id="hdr-joints">0</strong></div>
      <div class="kpi"><span>ğŸº+ğŸ·</span><strong id="hdr-alcohol">0</strong></div>
      <div class="kpi"><span>â‚¬</span><strong id="hdr-cost">0,00â‚¬</strong></div>
      <div class="kpi"><span>ğŸ’¶</span><strong id="hdr-saved">0,00â‚¬</strong></div>
    </div>
  </header>

  <!-- Tabs -->
  <nav id="tabs" class="tabs">
    <button class="tab active" data-tab="home">Accueil</button>
    <button class="tab" data-tab="stats">Stats</button>
    <button class="tab" data-tab="calendar">Calendrier</button>
    <button class="tab" data-tab="habits">Habitudes</button>
    <button class="tab" data-tab="settings">RÃ©glages</button>
  </nav>

  <!-- Pages -->
  <main class="pages">
    <!-- Accueil -->
    <section id="page-home">
      <div class="counters-grid">
        <article id="ctr-cigs" class="counter-card">
          <h2>Cigarettes</h2>
          <div class="ctr-row">
            <button class="btn" data-action="dec" data-kind="cigs">âˆ’1</button>
            <div class="ctr-val" id="val-cigs">0</div>
            <button class="btn" data-action="inc" data-kind="cigs">+1</button>
          </div>
          <label class="toggle"><input type="checkbox" id="chk-cigs-active" /> Activer</label>
        </article>

        <article id="ctr-joints" class="counter-card">
          <h2>Joints</h2>
          <div class="ctr-row">
            <button class="btn" data-action="dec" data-kind="joints">âˆ’1</button>
            <div class="ctr-val" id="val-joints">0</div>
            <button class="btn" data-action="inc" data-kind="joints">+1</button>
          </div>
          <label class="toggle"><input type="checkbox" id="chk-joints-active" /> Activer</label>
        </article>

        <article id="ctr-beer" class="counter-card">
          <h2>BiÃ¨re</h2>
          <div class="ctr-row">
            <button class="btn" data-action="dec" data-kind="beer">âˆ’1</button>
            <div class="ctr-val" id="val-beer">0</div>
            <button class="btn" data-action="inc" data-kind="beer">+1</button>
          </div>
          <label class="toggle"><input type="checkbox" id="chk-beer-active" /> Activer</label>
        </article>

        <article id="ctr-hard" class="counter-card">
          <h2>Alcool fort</h2>
          <div class="ctr-row">
            <button class="btn" data-action="dec" data-kind="hard">âˆ’1</button>
            <div class="ctr-val" id="val-hard">0</div>
            <button class="btn" data-action="inc" data-kind="hard">+1</button>
          </div>
          <label class="toggle"><input type="checkbox" id="chk-hard-active" /> Activer</label>
        </article>

        <article id="ctr-liqueur" class="counter-card">
          <h2>Liqueur</h2>
          <div class="ctr-row">
            <button class="btn" data-action="dec" data-kind="liqueur">âˆ’1</button>
            <div class="ctr-val" id="val-liqueur">0</div>
            <button class="btn" data-action="inc" data-kind="liqueur">+1</button>
          </div>
          <label class="toggle"><input type="checkbox" id="chk-liqueur-active" /> Activer</label>
        </article>
      </div>

      <!-- Conseils -->
      <section id="tips-root" class="tips-panel">
        <div class="tips-card">
          <!-- Tips insÃ©rÃ©s dynamiquement -->
        </div>
      </section>
    </section>

    <!-- Stats -->
    <section id="page-stats" class="hide">
      <div class="kpi-block">
        <h3>PÃ©riode</h3>
        <div id="stats-date">â€”</div>
      </div>
      <div class="chart-actions">
        <button id="btnPeriod-day" class="btn small">Jour</button>
        <button id="btnPeriod-week" class="btn small">Semaine</button>
        <button id="btnPeriod-month" class="btn small">Mois</button>
        <button id="btnPeriod-year" class="btn small">AnnÃ©e</button>
        <button id="btn-export-csv" class="btn small">Exporter CSV</button>
        <button id="btn-export-json" class="btn small">Exporter JSON</button>
        <label class="btn small">Importer JSON
          <input id="file-import-json" type="file" accept="application/json" hidden />
        </label>
      </div>
      <div class="chart-block">
        <canvas id="chart-main"></canvas>
      </div>
    </section>

    <!-- Calendrier -->
    <section id="page-calendar" class="hide">
      <div class="calendar-toolbar">
        <div class="toolbar-left">
          <button id="cal-prev" class="btn small">â—€</button>
          <div id="cal-title" class="cal-title">â€”</div>
          <button id="cal-next" class="btn small">â–¶</button>
        </div>
        <div class="toolbar-center">
          <button class="btn small" data-cal-mode="day">Jour</button>
          <button class="btn small" data-cal-mode="week">Semaine</button>
          <button class="btn small active" data-cal-mode="month">Mois</button>
        </div>
        <div class="toolbar-right cal-filters">
          <label><input type="checkbox" data-cal-filter="cigs" checked /> ğŸš¬</label>
          <label><input type="checkbox" data-cal-filter="joints" checked /> ğŸŒ¿</label>
          <label><input type="checkbox" data-cal-filter="beer" checked /> ğŸº</label>
          <label><input type="checkbox" data-cal-filter="hard" checked /> ğŸ¥ƒ</label>
          <label><input type="checkbox" data-cal-filter="liqueur" checked /> ğŸ¸</label>
        </div>
      </div>
      <div id="calendar-grid" class="cal-grid"></div>
      <div id="calendar-details" class="cal-details"></div>
      <div class="cal-links">
        <button id="cal-open-stats" class="btn small">Ouvrir Stats</button>
        <button id="cal-open-habits" class="btn small">Ouvrir Habitudes</button>
      </div>
    </section>

    <!-- Habitudes -->
    <section id="page-habits" class="hide">
      <h2 class="section-title">Objectifs par jour</h2>
      <div class="grid-2">
        <label>Cigarettes <input id="goal-cigs" type="number" min="0" /></label>
        <label>Joints <input id="goal-joints" type="number" min="0" /></label>
        <label>BiÃ¨re <input id="goal-beer" type="number" min="0" /></label>
        <label>Alcool fort <input id="goal-hard" type="number" min="0" /></label>
        <label>Liqueur <input id="goal-liqueur" type="number" min="0" /></label>
      </div>
      <div class="actions">
        <button id="btn-habits-save" class="btn">Enregistrer</button>
        <button id="btn-habits-reset" class="btn">RÃ©initialiser</button>
      </div>

      <h2 class="section-title">Dates clÃ©s</h2>
      <div class="grid-2">
        <label>ArrÃªt global <input id="date-stop-global" type="date" /></label>
        <label>ArrÃªt alcool <input id="date-stop-alcohol" type="date" /></label>

        <label>ArrÃªt clopes (dÃ©but rÃ©duction) <input id="date-reduce-cigs" type="date" /></label>
        <label>ArrÃªt clopes (objectif) <input id="date-quit-cigs-obj" type="date" /></label>
        <label>Clopes : plus jamais aprÃ¨s <input id="date-nomore-cigs" type="date" /></label>

        <label>ArrÃªt joints (dÃ©but rÃ©duction) <input id="date-reduce-joints" type="date" /></label>
        <label>ArrÃªt joints (objectif) <input id="date-quit-joints-obj" type="date" /></label>
        <label>Joints : plus jamais aprÃ¨s <input id="date-nomore-joints" type="date" /></label>

        <label>Alcool (dÃ©but rÃ©duction) <input id="date-reduce-alcohol" type="date" /></label>
        <label>Alcool (objectif arrÃªt) <input id="date-quit-alcohol-obj" type="date" /></label>
        <label>Alcool : plus jamais aprÃ¨s <input id="date-nomore-alcohol" type="date" /></label>
      </div>
    </section>

    <!-- RÃ©glages (structure minimale, le JS peut enrichir) -->
    <section id="page-settings" class="hide">
      <h2 class="section-title">Profil</h2>
      <div class="grid-2">
        <label>PrÃ©nom <input id="profile-name" type="text" placeholder="Votre prÃ©nom" /></label>
        <label>Langue <select id="select-language"></select></label>
      </div>

      <h2 class="section-title">Devise</h2>
      <div class="grid-2">
        <label>Symbole <input id="currency-symbol" type="text" value="â‚¬" /></label>
        <div>Position :
          <label><input type="radio" name="cur-pos" id="currency-before" /> Avant</label>
          <label><input type="radio" name="cur-pos" id="currency-after" /> AprÃ¨s</label>
        </div>
      </div>
      <div class="actions"><button id="btn-apply-currency" class="btn">Appliquer</button></div>

      <h2 class="section-title">Modules</h2>
      <div class="grid-2">
        <label><input type="checkbox" id="mod-cigs" /> Cigarettes</label>
        <label><input type="checkbox" id="mod-joints" /> Joints</label>
        <label><input type="checkbox" id="mod-beer" /> BiÃ¨re</label>
        <label><input type="checkbox" id="mod-hard" /> Alcool fort</label>
        <label><input type="checkbox" id="mod-liqueur" /> Liqueur</label>
        <label><input type="checkbox" id="mod-alcohol" /> Alcool (global)</label>
      </div>

      <h2 class="section-title">Prix unitaires</h2>
      <div class="grid-2">
        <label>Cigarette (â‚¬) <input id="price-cigarette" type="number" min="0" step="0.01" /></label>
        <label>Joint (â‚¬) <input id="price-joint" type="number" min="0" step="0.01" /></label>
        <label>BiÃ¨re (â‚¬) <input id="price-beer" type="number" min="0" step="0.01" /></label>
        <label>Alcool fort (â‚¬) <input id="price-hard" type="number" min="0" step="0.01" /></label>
        <label>Liqueur (â‚¬) <input id="price-liqueur" type="number" min="0" step="0.01" /></label>
      </div>
      <div class="actions">
        <button id="btn-save-prices" class="btn">Enregistrer les prix</button>
        <button id="btn-reset-prices" class="btn">RÃ©initialiser les prix</button>
      </div>

      <h2 class="section-title">Maintenance & sauvegardes</h2>
      <div class="actions">
        <button id="btn-raz-day" class="btn">RAZ du jour</button>
        <button id="btn-raz-history" class="btn">RAZ historique</button>
        <button id="btn-raz-factory" class="btn">RAZ rÃ©glages (usine)</button>
      </div>
      <div class="actions">
        <button id="btn-save-json-settings" class="btn">Sauvegarder JSON</button>
        <label class="btn">Importer JSON <input id="file-import-json-settings" type="file" accept="application/json" hidden /></label>
      </div>

      <h2 class="section-title">Journal & Debug</h2>
      <label><input type="checkbox" id="cb-debug-overlay" /> Afficher la console</label>
      <div class="actions">
        <button id="btn-copy-logs" class="btn">Copier les logs</button>
        <button id="btn-clear-logs" class="btn">Vider les logs</button>
        <button id="btn-resources" class="btn">Ressources & numÃ©ros utiles</button>
      </div>
      <div id="debug-console" class="hide"></div>
    </section>
  </main>

  <!-- Age gate -->
  <dialog id="agegate" class="hide">
    <form method="dialog" class="agegate">
      <h3>+18</h3>
      <p class="muted">StopAddict est une app dâ€™auto-suivi et dâ€™aide Ã  la rÃ©duction/arrÃªt (tabac, alcool, cannabis).</p>
      <p>Besoin dâ€™aide ? <a href="#" id="age-resources"
         onclick="document.getElementById('resources-dialog').showModal();return false;">Ressources et numÃ©ros utiles</a></p>
      <label><input type="checkbox" id="age-18plus" /> J'ai 18 ans ou plus</label>
      <label><input type="checkbox" id="age-hide" /> Ne plus afficher ce message</label>
      <div class="actions">
        <button value="cancel" class="btn">Annuler</button>
        <button id="btn-age-accept" class="btn" disabled>J'accepte et continue</button>
      </div>
    </form>
  </dialog>

  <!-- Resources dialog (fonctionne mÃªme sans fichier externe) -->
  <dialog id="resources-dialog" class="hide">
    <form method="dialog" class="agegate">
      <h3>Ressources & numÃ©ros utiles</h3>
      <div class="tips-card">
        <div class="tip-line"><span class="emoji">ğŸ“</span><div><strong>112</strong> â€” Urgences (UE) / <strong>15</strong> â€” SAMU (FR)</div></div>
        <div class="tip-line"><span class="emoji">ğŸ†˜</span><div><strong>3114</strong> â€” PrÃ©vention Suicide (FR)</div></div>
        <div class="tip-line"><span class="emoji">ğŸ¤</span><div><strong>0 800 23 13 13</strong> â€” Alcool Info Service</div></div>
        <div class="tip-line"><span class="emoji">ğŸƒ</span><div><strong>0 800 235 236</strong> â€” Drogues Info Service</div></div>
        <div class="tip-line"><span class="emoji">ğŸš­</span><div><strong>39 89</strong> â€” Tabac Info Service</div></div>
      </div>
      <div class="actions">
        <button class="btn">Fermer</button>
      </div>
    </form>
  </dialog>

  <!-- Vendor -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <!-- App -->
  <script type="module" src="./js/app.js?v=7"></script>
</body>
</html>
