<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>StopAddict</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- CSS principal (monolithe avait surtout du inline ; on ajoute le link pour que tes rÃ¨gles sâ€™appliquent) -->
  <link rel="stylesheet" href="./css/app.css">

  <style>
    /* Base minimale pour la dÃ©mo (tu peux garder ton gros bloc inline du monolithe ici si besoin) */
    :root { --bg:#0a0a0a; --fg:#fff; --muted:#999; --accent:#32b87b; --warn:#e86; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"; background:#111; color:#eee; }
    header, footer { background:#151515; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 12px; }
    h1,h2,h3 { margin: 0.2rem 0 0.6rem; }
    .row { display:flex; gap:.75rem; align-items:center; }
    .chip { display:inline-block; padding:.25rem .5rem; border-radius:999px; background:#222; border:1px solid #333; margin-right:.5rem; font-size:.9rem; }
    .chip-alcool { background:#202226; }
    .cards { display:grid; grid-template-columns: repeat(3, 1fr); gap:.75rem; }
    .card { background:#161616; border:1px solid #222; border-radius:12px; padding:12px; }
    .hide { display:none !important; }

    /* BanniÃ¨res */
    #banner-accueil, #banner-stats { background:#1a1a1a; border:1px solid #222; border-radius:12px; padding:12px; margin:12px 0; }
    #banner-stats { border-left: 4px solid #32b87b; }
    .row-alcool { opacity: .95; }

    /* Nav bas */
    .nav { position:fixed; left:0; right:0; bottom:0; background:#151515; border-top:1px solid #222; display:flex; }
    .nav button { flex:1; background:transparent; border:0; color:#ccc; padding:.8rem .4rem; font-size:.95rem; }
    .nav button.active, .nav button.actif { color:#fff; border-bottom: 2px solid #32b87b; }

    /* Ã‰crans */
    .screen { display:none; min-height: calc(100dvh - 56px - 56px); padding-bottom: 76px; }
    .screen.show, .screen.active, .screen.actif { display:block; }

    /* Modale 18+ (simple) */
    .modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,.6); z-index:1000; }
    .modal.show { display:flex; }
    .modal .panel { width:min(680px, 92vw); background:#141414; border:1px solid #333; border-radius:14px; padding:16px; }
    .modal .panel h3 { margin-top: 0; }
    .modal .panel footer { display:flex; gap:.5rem; justify-content:flex-end; background:transparent; border:0; padding:0; margin-top:10px; }
    .btn { border:1px solid #2a2a2a; background:#1b1b1b; color:#eee; padding:.5rem .75rem; border-radius:10px; cursor:pointer; }
    .btn:disabled { opacity:.5; cursor:not-allowed; }

    /* Calendrier (placeholder simple) */
    #cal-entete { display:flex; align-items:center; justify-content:space-between; margin: 8px 0 12px; }
    #cal-grille { display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; }
    #cal-grille .cell { background:#161616; border:1px solid #222; border-radius:8px; padding:10px; min-height:54px; }

    /* Zone export actions (Stats) */
    .stats-actions { display:flex; flex-wrap:wrap; gap:.5rem; margin-top:10px; }
  </style>
</head>
<body>

  <!-- HEADER (date/heure) -->
  <header>
    <div class="wrap row" style="justify-content:space-between;">
      <div class="row">
        <strong>StopAddict</strong>
      </div>
      <div class="row" style="gap:10px;">
        <span id="date-actuelle" aria-label="date du jour">â€”</span>
        <span id="heure-actuelle" aria-label="heure actuelle" style="color:#aaa;">â€”</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Ã‰CRAN : ACCUEIL -->
    <section id="ecran-principal" class="screen show actif active">
      <!-- Bandeau Accueil (monolithe) -->
      <div id="banner-accueil">
        <div id="hello-accueil">Bonjour ðŸ‘‹</div>
        <div id="chips-accueil" style="margin:6px 0 10px;">
          <span class="chip">Conseils du jour</span>
        </div>
        <div class="row">
          <div style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Cigarettes</div>
            <div id="bar-clopes" style="font-size:1.4rem;">â€”</div>
            <div id="note-clopes" style="color:#888;">â€”</div>
          </div>
          <div style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Joints</div>
            <div id="bar-joints" style="font-size:1.4rem;">â€”</div>
            <div id="note-joints" style="color:#888;">â€”</div>
          </div>
          <div class="row-alcool" style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Alcool</div>
            <div id="bar-alcool" style="font-size:1.4rem;">â€”</div>
            <div id="note-alcool" style="color:#888;">â€”</div>
          </div>
        </div>
      </div>

      <!-- Tes cartes actions (placeholders, tu peux conserver ta version) -->
      <div class="cards" style="margin-top:12px;">
        <div class="card" id="card-cigs">
          <h3>Clopes</h3>
          <div class="row">
            <button class="btn" id="cl-moins">âˆ’</button>
            <button class="btn" id="cl-plus">+</button>
          </div>
        </div>
        <div class="card" id="card-weed">
          <h3>Joints</h3>
          <div class="row">
            <button class="btn" id="j-moins">âˆ’</button>
            <button class="btn" id="j-plus">+</button>
          </div>
        </div>
        <div class="card" id="card-alcool">
          <h3>Alcool</h3>
          <div class="row">
            <button class="btn" id="a-moins">âˆ’</button>
            <button class="btn" id="a-plus">+</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Ã‰CRAN : STATS -->
    <section id="ecran-stats" class="screen">
      <!-- BanniÃ¨re Stats (monolithe) -->
      <div id="banner-stats">
        <div id="hello-stats">Statistiques â€” Aujourdâ€™hui</div>
        <div id="chips-stats" style="margin:6px 0 10px;">
          <span class="chip">Clopes : <strong>â€”</strong></span>
          <span class="chip">Joints : <strong>â€”</strong></span>
          <span class="chip chip-alcool">Alcool : <strong>â€”</strong></span>
        </div>
        <div class="row">
          <div style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Clopes (pÃ©riode)</div>
            <div id="bar-clopes-periode" style="font-size:1.4rem;">â€”</div>
            <div id="note-clopes-periode" style="color:#888;">â€”</div>
          </div>
          <div style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Joints (pÃ©riode)</div>
            <div id="bar-joints-periode" style="font-size:1.4rem;">â€”</div>
            <div id="note-joints-periode" style="color:#888;">â€”</div>
          </div>
          <div class="row-alcool" style="flex:1">
            <div style="font-size:.9rem; color:#aaa;">Alcool (pÃ©riode)</div>
            <div id="bar-alcool-periode" style="font-size:1.4rem;">â€”</div>
            <div id="note-alcool-periode" style="color:#888;">â€”</div>
          </div>
        </div>
      </div>

      <!-- Canvases aux IDs du monolithe -->
      <div class="row" style="gap:12px; align-items:stretch;">
        <div style="flex:2; min-height:260px; background:#161616; border:1px solid #222; border-radius:12px; padding:10px;">
          <canvas id="chart-consommations" style="width:100%; height:240px;"></canvas>
        </div>
        <div style="flex:1; min-height:260px; background:#161616; border:1px solid #222; border-radius:12px; padding:10px;">
          <canvas id="chart-cout-eco" style="width:100%; height:240px;"></canvas>
        </div>
      </div>

      <!-- Actions export (exemple) -->
      <div class="stats-actions">
        <button class="btn">Exporter la vue actuelle</button>
        <button class="btn">Importer (CSV/JSON)</button>
        <button class="btn">Exporter lâ€™historique complet (Excel)</button>
      </div>
    </section>

    <!-- Ã‰CRAN : CALENDRIER -->
    <section id="ecran-calendrier" class="screen">
      <div id="cal-entete">
        <button class="btn" id="cal-prev">â†</button>
        <div id="cal-titre"><strong>Octobre 2025</strong></div>
        <button class="btn" id="cal-next">â†’</button>
      </div>
      <div id="cal-grille">
        <!-- rendu JS par calendar.js -->
        <div class="cell">1</div><div class="cell">2</div><div class="cell">3</div><div class="cell">4</div><div class="cell">5</div><div class="cell">6</div><div class="cell">7</div>
      </div>
    </section>

    <!-- Ã‰CRAN : HABITUDES -->
    <section id="ecran-habitudes" class="screen">
      <h2>Habitudes / Limites</h2>
      <p>RÃ¨gles quotidiennes, objectifs et jalonsâ€¦</p>
      <!-- Contenu rendu/lu par limits.js, etc. -->
    </section>

    <!-- Ã‰CRAN : RÃ‰GLAGES (plein Ã©cran, monolithe) -->
    <section id="ecran-params" class="screen">
      <h2>RÃ©glages</h2>
      <div class="row" style="gap:12px; flex-wrap:wrap; margin: 8px 0 14px;">
        <button class="btn" id="open-manuel">ðŸ“˜ Manuel</button>
        <button class="btn" id="open-ressources">ðŸ†˜ Ressources utiles</button>
        <button class="btn" id="open-cgv">ðŸ“„ CGU / CGV</button>
        <button class="btn" id="open-mentions">â„¹ï¸ Mentions lÃ©gales</button>
        <button class="btn" id="open-export-json">ðŸ’¾ Export JSON</button>
        <button class="btn" id="open-export-csv">ðŸ’¾ Export CSV</button>
        <button class="btn" id="open-export-view">ðŸ’¾ Export vue Stats</button>
        <button class="btn" id="open-import">ðŸ“¥ Importer (CSV/JSON)</button>
      </div>

      <div class="cards" style="grid-template-columns: repeat(2, 1fr);">
        <div class="card">
          <h3>Personnalisation</h3>
          <p>Affichage, modules visibles (clopes/weed/alcool)â€¦</p>
          <div class="row">
            <label><input type="checkbox" id="toggle-cigs" checked> Afficher Clopes</label>
          </div>
          <div class="row">
            <label><input type="checkbox" id="toggle-weed" checked> Afficher Joints</label>
          </div>
          <div class="row">
            <label><input type="checkbox" id="toggle-alcool" checked> Afficher Alcool</label>
          </div>
        </div>
        <div class="card">
          <h3>Prix</h3>
          <p>Prix des cigarettes, cannabis, alcoolâ€¦</p>
          <small style="color:#888;">(Saisi gÃ©rÃ©e dans tes modules dÃ©diÃ©s si existants)</small>
        </div>
        <div class="card">
          <h3>Objectifs & Dates</h3>
          <p>DÃ©finir des jalons, sevrage, etc.</p>
        </div>
        <div class="card">
          <h3>Ã€ propos</h3>
          <p>Version locale, donnÃ©es stockÃ©es sur lâ€™appareil.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- NAVIGATION BAS (5 onglets, monolithe) -->
  <nav class="nav">
    <button id="nav-principal"   class="active">Accueil</button>
    <button id="nav-stats">Stats</button>
    <button id="nav-calendrier">Calendrier</button>
    <button id="nav-habitudes">Habitudes</button>
    <button id="nav-params">RÃ©glages</button>
  </nav>

  <!-- MODALE 18+ -->
  <div id="modal-warn" class="modal" aria-hidden="true">
    <div class="panel">
      <h3>Contenu rÃ©servÃ© aux majeurs (+18)</h3>
      <p>Cette application traite de consommation de tabac, cannabis et alcool.</p>
      <div style="margin:8px 0;">
        <label><input type="checkbox" id="chk-warn-18"> Jâ€™ai 18 ans ou plus</label><br>
        <label><input type="checkbox" id="chk-warn-hide"> Ne plus rÃ©afficher ce message</label>
      </div>
      <p><a href="#" id="open-ressources-from-warn">Ressources et numÃ©ros utiles</a></p>
      <footer>
        <button id="btn-warn-cancel" class="btn">Annuler</button>
        <button id="btn-warn-quit" class="btn">Quitter</button>
        <button id="btn-warn-accept" class="btn" disabled>Jâ€™accepte et continuer</button>
      </footer>
    </div>
  </div>

  <!-- SCRIPTS -->
  <!-- Chart.js UMD v4 (AVANT app.js) -->
  <script src="./vendor/chart.umd.min.js"></script>
  <!-- App principal (modules ES) -->
  <script type="module" src="./js/app.js"></script>
</body>
</html>
