<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StopAddict</title>
  <style>
    /* Mini styles pour vérifier le fonctionnement (tu pourras remettre ton CSS ensuite) */
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#0b1220;color:#e5e7eb}
    header,nav,main,section{width:100%}
    header{background:#111a2e;border-bottom:1px solid #1a2642;padding:.75rem 1rem}
    .topbar{display:flex;gap:1rem;flex-wrap:wrap;font-size:.95rem}
    .topbar span{opacity:.95}
    nav{display:flex;gap:.5rem;flex-wrap:wrap;padding:.5rem 1rem;background:#0e1729;border-bottom:1px solid #1a2642}
    nav button{background:#1a2642;color:#e5e7eb;border:0;padding:.5rem .75rem;border-radius:.5rem;cursor:pointer}
    nav button.actif{background:#3b82f6}
    .wrap{padding:1rem}
    .row{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
    .card{background:#111a2e;border:1px solid #1a2642;border-radius:.75rem;padding:1rem;margin:0 0 1rem 0}
    .title{font-weight:700;margin-bottom:.5rem}
    .muted{opacity:.8;font-size:.9rem}
    .btn{background:#1a2642;border:1px solid #243353;color:#e5e7eb;border-radius:.5rem;padding:.5rem .75rem;cursor:pointer}
    #debug-console{display:none;position:fixed;left:0;right:0;bottom:0;max-height:35vh;overflow:auto;background:#0a0f1d;border-top:1px solid #1a2642;padding:.5rem;font:12px/1.4 ui-monospace,Consolas,Monaco,monospace;color:#9ca3af}
    canvas{max-width:100%;background:#0e1729;border:1px solid #1a2642;border-radius:.5rem}
  </style>
</head>
<body>

  <!-- Bandeau haut (résumé du jour) -->
  <header>
    <div class="topbar">
      <span data-i18n="today.title">Aujourd’hui</span> |
      <span><b data-i18n="counts.cigs">Clopes</b> : <span id="bar-clopes">0</span></span>
      <span><b data-i18n="counts.weed">Joints</b> : <span id="bar-joints">0</span></span>
      <span><b data-i18n="counts.alcohol">Alcool</b> : <span id="bar-alcool">0</span></span>
      <span><b data-i18n="cost">Coût</b> : <span id="bar-cost" data-money="0">0</span></span>
      <span><b data-i18n="savings">Économies</b> : <span id="bar-eco" data-money="0">0</span></span>
    </div>
  </header>

  <!-- Navigation -->
  <nav>
    <button id="nav-accueil"     data-target="ecran-accueil"     class="actif" data-i18n="nav.home">Accueil</button>
    <button id="nav-stats"       data-target="ecran-stats"       data-i18n="nav.stats">Stats</button>
    <button id="nav-calendrier"  data-target="ecran-calendrier"  data-i18n="nav.calendar">Calendrier</button>
    <button id="nav-habitudes"   data-target="ecran-habitudes"   data-i18n="nav.habits">Habitudes</button>
    <button id="nav-params"      data-target="ecran-params"      data-i18n="nav.settings">Réglages</button>
  </nav>

  <main class="wrap">
    <!-- ACCUEIL -->
    <section id="ecran-accueil" style="display:block">
      <div class="card">
        <div class="title" data-i18n="today.title">Aujourd’hui</div>
        <!-- Hôte pour les conseils -->
        <div id="tips-box" class="muted" data-i18n="tips.title">Conseils</div>
      </div>

      <!-- Blocs d’action simples (+/−). Les modules peuvent s’y accrocher. -->
      <div class="grid-3">
        <div class="card">
          <div class="title" data-i18n="cat.cigs">Cigarettes</div>
          <div class="row">
            <button class="btn" id="btn-cigs-minus" data-kind="cigs" data-delta="-1">−</button>
            <button class="btn" id="btn-cigs-plus"  data-kind="cigs" data-delta="+1">+</button>
            <span class="muted">(<span id="count-cigs">0</span>)</span>
          </div>
        </div>
        <div class="card">
          <div class="title" data-i18n="cat.weed">Joints</div>
          <div class="row">
            <button class="btn" id="btn-weed-minus" data-kind="weed" data-delta="-1">−</button>
            <button class="btn" id="btn-weed-plus"  data-kind="weed" data-delta="+1">+</button>
            <span class="muted">(<span id="count-weed">0</span>)</span>
          </div>
        </div>
        <div class="card">
          <div class="title" data-i18n="cat.beer">Bière</div>
          <div class="row">
            <button class="btn" id="btn-beer-minus" data-kind="beer" data-delta="-1">−</button>
            <button class="btn" id="btn-beer-plus"  data-kind="beer" data-delta="+1">+</button>
            <span class="muted">(<span id="count-beer">0</span>)</span>
          </div>
        </div>
        <div class="card">
          <div class="title" data-i18n="cat.strong">Alcool fort</div>
          <div class="row">
            <button class="btn" id="btn-strong-minus" data-kind="strong" data-delta="-1">−</button>
            <button class="btn" id="btn-strong-plus"  data-kind="strong" data-delta="+1">+</button>
            <span class="muted">(<span id="count-strong">0</span>)</span>
          </div>
        </div>
        <div class="card">
          <div class="title" data-i18n="cat.liquor">Liqueur</div>
          <div class="row">
            <button class="btn" id="btn-liquor-minus" data-kind="liquor" data-delta="-1">−</button>
            <button class="btn" id="btn-liquor-plus"  data-kind="liquor" data-delta="+1">+</button>
            <span class="muted">(<span id="count-liquor">0</span>)</span>
          </div>
        </div>
      </div>
    </section>

    <!-- STATS -->
    <section id="ecran-stats" style="display:none">
      <div class="card">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div class="title" id="stats-titre">Bilan</div>
          <div class="row">
            <button class="btn" id="btn-range-day"   data-range="day"   data-i18n="range.day">Jour</button>
            <button class="btn" id="btn-range-week"  data-range="week"  data-i18n="range.week">Semaine</button>
            <button class="btn" id="btn-range-month" data-range="month" data-i18n="range.month">Mois</button>
            <button class="btn" id="btn-range-year"  data-range="year"  data-i18n="range.year">Année</button>
          </div>
        </div>
        <canvas id="chart-main" data-exportable-chart width="900" height="360"></canvas>
      </div>

      <div class="card">
        <div class="title">Export / Import</div>
        <div class="row">
          <label class="row" style="gap:.35rem">
            <input type="checkbox" id="export-include-charts" />
            <span class="muted" data-i18n="export.include_charts">Inclure images des graphiques</span>
          </label>
          <button class="btn" id="btn-export-csv"  data-i18n="export.csv">Exporter CSV</button>
          <button class="btn" id="btn-export-json" data-i18n="export.json">Exporter TOUT (JSON)</button>
          <button class="btn" id="btn-import-json" data-i18n="import.json">Importer (JSON)</button>
        </div>
      </div>
    </section>

    <!-- CALENDRIER -->
    <section id="ecran-calendrier" style="display:none">
      <div class="card">
        <div class="title" data-i18n="nav.calendar">Calendrier</div>
        <div id="calendar-host"></div>
      </div>
    </section>

    <!-- HABITUDES -->
    <section id="ecran-habitudes" style="display:none">
      <div class="card">
        <div class="title" data-i18n="habits.title">Habitudes</div>
        <div id="habits-host"></div>
      </div>
    </section>

    <!-- RÉGLAGES (injecté par settings.js) -->
    <section id="ecran-params" style="display:none">
      <!-- Le formulaire complet est injecté ici -->
    </section>
  </main>

  <!-- Console debug intégrée (F12 si besoin, sinon Ctrl+Shift+D selon ton module) -->
  <div id="debug-console"></div>

  <!-- App (ES modules) -->
  <script type="module" src="./js/app.js"></script>
</body>
</html>
