<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StopAddict — Suivi conso</title>

  <!-- Ton CSS (garde le chemin) -->
  <link rel="stylesheet" href="./style.css" />

  <!-- Chart.js global (utilisé par app.js -> renderChart) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <!-- En-tête -->
  <header id="topbar">
    <h1 id="app-title">StopAddict</h1>
    <div id="top-infos">
      <span id="today-date">--/--/----</span>
      <span>Clopes : <b id="hdr-cigs">0</b></span>
      <span>Joints : <b id="hdr-joints">0</b></span>
      <span>Alcool : <b id="hdr-alcohol">0</b></span>
      <span>Coût : <b id="hdr-cost">0,00€</b></span>
      <span>Économies : <b id="hdr-saved">0,00€</b></span>
      <span id="hdr-status" aria-label="statut">•</span>
    </div>
  </header>

  <!-- Navigation -->
  <nav id="tabs">
    <button class="tab active" data-tab="home">Accueil</button>
    <button class="tab" data-tab="stats">Stats</button>
    <button class="tab" data-tab="calendar">Calendrier</button>
    <button class="tab" data-tab="habits">Habitudes</button>
    <button class="tab" data-tab="settings">Réglages</button>
  </nav>

  <main>
    <!-- Accueil -->
    <section id="page-home">
      <div class="panel">
        <h2>Aujourd'hui</h2>
        <p>Renseigne les prix dans Réglages pour des coûts/économies réalistes.</p>
      </div>

      <div class="grid-counters">
        <!-- Cigarettes -->
        <div id="ctr-cigs" class="counter-card">
          <h3>Cigarettes</h3>
          <div class="ctr-row">
            <button data-kind="cigs" data-action="dec" aria-label="moins">−</button>
            <span id="val-cigs">0</span>
            <button data-kind="cigs" data-action="inc" aria-label="plus">+</button>
          </div>
          <label><input type="checkbox" id="chk-cigs-active"> Activer</label>
        </div>

        <!-- Joints -->
        <div id="ctr-joints" class="counter-card">
          <h3>Joints</h3>
          <div class="ctr-row">
            <button data-kind="joints" data-action="dec">−</button>
            <span id="val-joints">0</span>
            <button data-kind="joints" data-action="inc">+</button>
          </div>
          <label><input type="checkbox" id="chk-joints-active"> Activer</label>
        </div>

        <!-- Bière -->
        <div id="ctr-beer" class="counter-card">
          <h3>Bière</h3>
          <div class="ctr-row">
            <button data-kind="beer" data-action="dec">−</button>
            <span id="val-beer">0</span>
            <button data-kind="beer" data-action="inc">+</button>
          </div>
          <label><input type="checkbox" id="chk-beer-active"> Activer</label>
        </div>

        <!-- Alcool fort -->
        <div id="ctr-hard" class="counter-card">
          <h3>Alcool fort</h3>
          <div class="ctr-row">
            <button data-kind="hard" data-action="dec">−</button>
            <span id="val-hard">0</span>
            <button data-kind="hard" data-action="inc">+</button>
          </div>
          <label><input type="checkbox" id="chk-hard-active"> Activer</label>
        </div>

        <!-- Liqueur -->
        <div id="ctr-liqueur" class="counter-card">
          <h3>Liqueur</h3>
          <div class="ctr-row">
            <button data-kind="liqueur" data-action="dec">−</button>
            <span id="val-liqueur">0</span>
            <button data-kind="liqueur" data-action="inc">+</button>
          </div>
          <label><input type="checkbox" id="chk-liqueur-active"> Activer</label>
        </div>
      </div>
    </section>

    <!-- Stats -->
    <section id="page-stats" class="hide">
      <div class="panel">
        <h2>Bilan <span id="stats-date"></span></h2>
        <div class="btn-group">
          <button id="btnPeriod-day">Jour</button>
          <button id="btnPeriod-week">Semaine</button>
          <button id="btnPeriod-month">Mois</button>
          <button id="btnPeriod-year">Année</button>
        </div>
        <div class="chart-wrap">
          <canvas id="chart-main" height="320"></canvas>
        </div>
      </div>

      <div class="panel">
        <h3>Export / Import</h3>
        <div class="btn-group">
          <button id="btn-export-csv">Exporter CSV</button>
          <button id="btn-export-json">Exporter TOUT (JSON)</button>
          <label class="btn">
            Importer (JSON)
            <input id="file-import-json" type="file" accept="application/json" hidden>
          </label>
        </div>
      </div>
    </section>

    <!-- Calendrier -->
    <section id="page-calendar" class="hide">
      <div class="panel">
        <h2>Calendrier</h2>
        <div id="calendar-root"></div>
      </div>
    </section>

    <!-- Habitudes -->
    <section id="page-habits" class="hide">
      <div class="panel">
        <h2>Objectifs quotidiens</h2>
        <div class="grid-5">
          <label>Clopes / jour <input id="goal-cigs" type="number" min="0" step="1" /></label>
          <label>Joints / jour <input id="goal-joints" type="number" min="0" step="1" /></label>
          <label>Bière / jour <input id="goal-beer" type="number" min="0" step="1" /></label>
          <label>Alcool fort / jour <input id="goal-hard" type="number" min="0" step="1" /></label>
          <label>Liqueur / jour <input id="goal-liqueur" type="number" min="0" step="1" /></label>
        </div>
        <div class="btn-group">
          <button id="btn-habits-save">Enregistrer</button>
          <button id="btn-habits-reset">Réinitialiser</button>
        </div>
      </div>

      <div class="panel">
        <h2>Dates clés</h2>
        <div class="grid-3">
          <label>Arrêt global <input id="date-stop-global" type="date"></label>
          <label>Arrêt alcool (global) <input id="date-stop-alcohol" type="date"></label>
          <label>Arrêt cigarettes <input id="date-stop-cigs" type="date"></label>

          <label>Début réduction clopes <input id="date-reduce-cigs" type="date"></label>
          <label>Objectif arrêt clopes <input id="date-quit-cigs-obj" type="date"></label>
          <label>Plus censé fumer (clopes) <input id="date-nomore-cigs" type="date"></label>

          <label>Arrêt joints <input id="date-stop-joints" type="date"></label>
          <label>Début réduction joints <input id="date-reduce-joints" type="date"></label>
          <label>Objectif arrêt joints <input id="date-quit-joints-obj" type="date"></label>
          <label>Plus censé fumer (joints) <input id="date-nomore-joints" type="date"></label>

          <label>Début réduction alcool <input id="date-reduce-alcohol" type="date"></label>
          <label>Objectif arrêt alcool <input id="date-quit-alcohol-obj" type="date"></label>
          <label>Plus censé boire <input id="date-nomore-alcohol" type="date"></label>
        </div>
      </div>
    </section>

    <!-- Réglages -->
    <section id="page-settings" class="hide">
      <div class="panel">
        <h2>Profil</h2>
        <label>Prénom (facultatif) <input id="profile-name" type="text" placeholder="Ex : Nicolas" /></label>
        <label>Langue
          <select id="select-language">
            <!-- I18N remplira / fallback FR/EN dans app.js -->
          </select>
        </label>
      </div>

      <div class="panel">
        <h2>Devise (affichage)</h2>
        <label>Symbole <input id="currency-symbol" type="text" value="€" /></label>
        <div class="row">
          <label><input type="radio" name="curpos" id="currency-before"> Avant (ex: €12,00)</label>
          <label><input type="radio" name="curpos" id="currency-after"> Après (ex: 12,00€)</label>
        </div>
        <button id="btn-apply-currency">Appliquer</button>
      </div>

      <div class="panel">
        <h2>Modules</h2>
        <div class="grid-3">
          <label><input type="checkbox" id="mod-cigs"> Cigarettes</label>
          <label><input type="checkbox" id="mod-joints"> Joints</label>
          <label><input type="checkbox" id="mod-beer"> Bière</label>
          <label><input type="checkbox" id="mod-hard"> Alcool fort</label>
          <label><input type="checkbox" id="mod-liqueur"> Liqueur</label>
          <label><input type="checkbox" id="mod-alcohol"> Alcool (global)</label>
        </div>
        <p class="muted">Si “Alcool (global)” est coché, les sous-catégories Bière/Alcool fort/Liqueur sont neutralisées (logique gérée dans settings.js).</p>
      </div>

      <div class="panel">
        <h2>Prix unitaires</h2>
        <div class="grid-5">
          <label>Cigarette (€) <input id="price-cigarette" type="number" min="0" step="0.01" /></label>
          <label>Joint (€) <input id="price-joint" type="number" min="0" step="0.01" /></label>
          <label>Bière (€) <input id="price-beer" type="number" min="0" step="0.01" /></label>
          <label>Alcool fort (€) <input id="price-hard" type="number" min="0" step="0.01" /></label>
          <label>Liqueur (€) <input id="price-liqueur" type="number" min="0" step="0.01" /></label>
        </div>
        <div class="btn-group">
          <button id="btn-save-prices">Enregistrer</button>
          <button id="btn-reset-prices">Réinitialiser prix</button>
        </div>
      </div>

      <div class="panel">
        <h2>RAZ & sauvegardes</h2>
        <div class="btn-group">
          <button id="btn-raz-day">RAZ du jour</button>
          <button id="btn-raz-history">RAZ historique</button>
          <button id="btn-raz-factory">RAZ réglages (usine)</button>
        </div>
        <div class="btn-group">
          <button id="btn-save-json-settings">Sauvegarder JSON</button>
          <label class="btn">Importer JSON
            <input id="file-import-json-settings" type="file" accept="application/json" hidden>
          </label>
        </div>
      </div>

      <div class="panel">
        <h2>Journal & DEBUG</h2>
        <label><input id="cb-debug-overlay" type="checkbox"> Overlay DEBUG (afficher)</label>
        <div class="btn-group">
          <button id="btn-copy-logs">Copier les logs</button>
          <button id="btn-clear-logs">Vider les logs</button>
        </div>
      </div>

      <div class="panel">
        <h2>Ressources utiles</h2>
        <button id="btn-resources">Ouvrir la liste</button>
      </div>
    </section>
  </main>

  <!-- Modale âge légal -->
  <dialog id="agegate" class="modal">
    <form method="dialog">
      <h3>Avertissement</h3>
      <p>Cette application s'adresse aux personnes majeures.</p>
      <label><input type="checkbox" id="age-18plus"> J'ai 18 ans ou plus</label><br>
      <label><input type="checkbox" id="age-hide"> Ne plus afficher</label>
      <div class="btn-group">
        <button id="btn-age-accept" value="ok" disabled>J'accepte et continuer</button>
      </div>
    </form>
  </dialog>

  <!-- Console debug (toggle 5 taps sur la date) -->
  <div id="debug-console" class="hide" aria-live="polite"></div>

  <!-- App (ES modules) -->
  <script type="module" src="./js/app.js"></script>
</body>
</html>
