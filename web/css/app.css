/* web/css/app.css — look “appli”, parité visuelle monolithe, grilles propres */

/* ---------- Thème ---------- */
:root{
  --bg: #0a1224;           /* fond général */
  --bg-app: #0f172a;       /* fond wrapper */
  --panel: #0c1222;        /* cartes/panels */
  --panel-2:#111a33;
  --border:#1f2b48;
  --dash:  #24365f;
  --text:  #eaf0ff;
  --muted: #c6d7ff;
  --accent:#35518a;
  --accent-2:#15213a;
  --ok:   #124232;
}

/* ---------- Reset minimal ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  color:var(--text);
  background: radial-gradient(1200px 700px at 50% -100px,#0b1633 0%,#061024 55%,#040a18 100%), var(--bg);
}

/* Utilitaires */
.hide{display:none!important;}
.btn{border:0;padding:.55rem .9rem;border-radius:.6rem;background:#1e293b;color:var(--text);cursor:pointer;transition:transform .05s ease,background .2s ease}
.btn:hover{background:#273449}
.btn:active{transform:translateY(1px)}
.btn.small{padding:.4rem .65rem;font-size:.9rem}

/* ---------- Wrapper “app” (look mobile) ---------- */
.app{
  width:100%;
  max-width: 430px;            /* largeur téléphone */
  margin: 20px auto;
  background: var(--bg-app);
  border: 1px solid #22304a;
  border-radius: 22px;
  box-shadow: 0 30px 60px rgba(0,0,0,.45), 0 2px 10px rgba(0,0,0,.25);
  overflow: clip;              /* évite les débords en sticky */
  min-height: 88vh;
}
@media (max-width:480px){ .app{ margin:0; max-width:none; border-radius:0; min-height:100vh; } }

/* ---------- Header ---------- */
.app-header{
  display:grid; grid-template-columns:1fr auto; align-items:center;
  padding:1rem 1.2rem;
  border-bottom:1px solid var(--border);
  background: linear-gradient(180deg,var(--panel-2),var(--bg-app) 70%);
  position:sticky; top:0; z-index:10;
}
.header-left h1{margin:0 0 .25rem 0;font-size:1.25rem}
.date-line{display:flex;align-items:center;gap:.5rem;opacity:.9}
.status-dot{
  display:inline-flex;align-items:center;justify-content:center;
  width:1.15rem;height:1.15rem;border-radius:50%;
  background:#1f2b48;color:#cce3ff;font-weight:700;font-size:.85rem
}
.kpis{display:flex;align-items:center;gap:.4rem}
.kpi{background:var(--panel);border:1px solid var(--border);padding:.35rem .55rem;border-radius:.55rem;display:flex;align-items:center;gap:.4rem}

/* ---------- Tabs ---------- */
.tabs{
  display:flex;gap:.35rem;padding:.45rem .7rem;
  border-bottom:1px solid var(--border);
  position:sticky; top:58px; z-index:9; background:var(--bg-app)
}
.tab{
  background:transparent;color:#cde2ff;border:0;padding:.6rem .9rem;cursor:pointer;border-radius:.55rem;font-weight:600
}
.tab.active{background:var(--accent-2);color:#fff;border:1px solid #253154}

/* ---------- Pages ---------- */
.pages{padding:1rem}

/* ---------- Accueil / Compteurs ---------- */
.counters-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:.9rem}
@media (min-width:420px){.counters-grid{grid-template-columns:repeat(2,1fr)}}
.counter-card{
  background:var(--panel);border:1px solid var(--border);
  border-radius:1rem;padding:.9rem;display:flex;flex-direction:column;gap:.6rem;min-height:160px
}
.counter-card h2{margin:0;font-size:1.05rem;color:#f2f7ff}
.ctr-row{display:grid;grid-template-columns:44px 1fr 44px;align-items:center;gap:.6rem}
.ctr-val{background:#0b1020;border:1px dashed var(--dash);padding:.5rem;text-align:center;border-radius:.6rem;font-size:1.2rem;font-weight:700}
.toggle{display:flex;align-items:center;gap:.5rem;color:var(--muted);font-size:.95rem}

/* ---------- Tips ---------- */
.tips-panel{margin-top:1rem}
.tips-card{background:var(--panel);border:1px solid var(--border);border-radius:1rem;padding:.9rem}
.tips-card h3{margin:0 0 .5rem 0}
.tip-line{padding:.35rem .5rem;background:#0b1220;border:1px dashed var(--dash);border-radius:.5rem;margin-bottom:.4rem}

/* ---------- Stats ---------- */
.kpi-block{display:flex;align-items:baseline;gap:1rem;margin:.4rem 0 1rem 0}
.chart-actions{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.8rem}
.charts-grid{display:grid;grid-template-columns:1fr;gap:.75rem}
.chart-block{background:var(--panel);border:1px solid var(--border);border-radius:1rem;padding:.5rem;height:300px}
#chart-main,#chart-cost{width:100%;height:100%}
@media (min-width:420px){ .chart-block{height:340px} }

/* ---------- Calendrier (grille mensuelle) ---------- */
.calendar-toolbar{
  display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-bottom:.7rem;flex-wrap:wrap
}
.toolbar-left{display:flex;align-items:center;gap:.5rem}
.cal-title{min-width:180px;text-align:center;font-weight:700}
.cal-filters label{display:inline-flex;align-items:center;gap:.25rem;margin-left:.25rem}

.cal-grid{background:var(--panel);border:1px solid var(--border);border-radius:1rem;overflow:hidden}
.cal-head{display:grid;grid-template-columns:repeat(7,1fr);background:#121a2f;border-bottom:1px solid var(--border)}
.cal-head>div{padding:.5rem;text-align:center;color:#c9d9ff;font-weight:600}
.cal-body{display:grid;grid-template-columns:repeat(7,1fr)}
.cal-cell{min-height:92px;border-right:1px solid #1a2744;border-bottom:1px solid #1a2744;padding:.45rem;position:relative}
.cal-cell:nth-child(7n){border-right:0}
.cal-other{opacity:.45}
.cal-today{outline:2px solid var(--accent);outline-offset:-2px}
.cal-day{font-weight:700;color:#f2f7ff}
.cal-mini{position:absolute;right:.4rem;bottom:.4rem;display:flex;gap:.25rem}
.mini-dot{display:inline-block;padding:.05rem .35rem;border-radius:.5rem;background:#1f2b48}
.mini-euro{display:inline-block;padding:.05rem .3rem;border-radius:.5rem;border:1px solid #2a3a61}

.cal-details{margin-top:.7rem}
.cal-details .cal-box{background:var(--panel);border:1px solid var(--border);border-radius:1rem;padding:.9rem}
.cal-box h4{margin:.2rem 0 .6rem 0}
.cal-summary{display:grid;grid-template-columns:repeat(4,1fr);gap:.45rem}
@media(max-width:380px){.cal-summary{grid-template-columns:repeat(2,1fr)}}
.cal-summary>div{background:#0b1020;border:1px dashed var(--dash);padding:.5rem;border-radius:.5rem;text-align:center}

/* ---------- Habits / Réglages ---------- */
.section-title{margin:1rem 0 .6rem 0;font-size:1.05rem}
.grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:.65rem}
@media (max-width:380px){.grid-2{grid-template-columns:1fr}}
.grid-2 label{
  display:flex;align-items:center;justify-content:space-between;gap:.6rem;
  background:var(--panel);border:1px solid var(--border);padding:.6rem .7rem;border-radius:.6rem
}
.grid-2 input,.grid-2 select{
  width:150px;max-width:48%;
  padding:.45rem .55rem;border-radius:.5rem;border:1px solid #2a3a61;background:#0b1020;color:var(--text)
}
.actions{display:flex;flex-wrap:wrap;gap:.5rem;margin:.7rem 0}

/* ---------- Debug ---------- */
#debug-console{
  margin-top:.6rem;padding:.6rem;height:160px;overflow:auto;
  background:#0b1020;border:1px solid #233355;border-radius:.6rem
}
.debug-line{
  font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;
  font-size:.85rem
}

/* ---------- Dialogs (AgeGate + Ressources) ---------- */
dialog{
  border:0;border-radius:16px;
  background:var(--panel);color:var(--text);
  padding:1rem;max-width: 520px;width:min(92vw,520px)
}
dialog::backdrop{background:rgba(2,6,23,.58)}
/* priorité d’empilement : Ressources > AgeGate */
#agegate[open]{z-index:1000}
#resources-dialog[open]{z-index:1100}

.agegate{min-width:260px;display:grid;gap:.6rem}
.agegate h3{margin:0}
.agegate .actions{display:flex;justify-content:flex-end;gap:.5rem}

/* ---------- Divers ---------- */
.kpis,.actions,.grid-2{gap:.7rem}
